{% load static %}
<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}CapyDjango{% endblock %}</title>

  {# Бутстрап можно оставить подключённым — но мы его здесь не используем #}
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        rel="stylesheet" crossorigin="anonymous">

  <style>
    :root {
      --border:#e5e7eb;
      --bg:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --brand:#2563eb;

      .inline-logout { display:inline; margin:0; }
      .linklike {
          background:none; border:0; padding:0;
          color:#2563eb; text-decoration:underline;
          cursor:pointer; font:inherit;
      }
      .linklike:hover { opacity:.8; }

    }
    html, body { height:100%; }
    body.page { margin:0; background:var(--bg); color:var(--text); }

    /* Шапка */
    .site-header {
      position:sticky; top:0; z-index:10;
      display:flex; align-items:center; gap:16px;
      padding:12px 16px; border-bottom:1px solid var(--border);
      background:var(--bg);
    }
    .brand {
      font-weight:700; font-size:18px; text-decoration:none; color:var(--text);
    }
    .header-spacer { flex:1; }
    .avatar-link { display:inline-block; line-height:0; }
    .avatar {
      height:32px; width:32px; object-fit:cover; border-radius:8px;
      transition: transform .15s ease, box-shadow .15s ease, opacity .15s ease;
    }
    .avatar-link:hover .avatar { transform: translateY(-1px); box-shadow:0 2px 10px rgba(0,0,0,.08); }
    .avatar--guest { opacity:.9; }

    /* Основная зона: слева навигация, справа контент */
    .page-main { display:flex; min-height:calc(100vh - 57px); } /* 57px ≈ высота шапки */
    .side {
      width:240px; border-right:1px solid var(--border); background:var(--bg);
    }
    .content {
      flex:1; padding:24px; min-width:0;
    }

    /* Футер */
    .site-footer {
      border-top:1px solid var(--border);
      padding:16px; text-align:center; color:var(--muted);
      background:var(--bg);
    }

    /* Адаптив */
    @media (max-width: 900px) {
      .page-main { flex-direction:column; }
      .side { width:100%; border-right:0; border-bottom:1px solid var(--border); }
    }
  </style>
</head>
<body class="page">

  <header class="site-header">
    <a class="brand" href="{% url 'main:home' %}">CapyDjango</a>
    <div class="header-spacer"></div>

    {# Иконка кабинет / логин #}
    {% if request.user.is_authenticated %}
      <a class="avatar-link" href="{% url 'cabinet' %}" title="Кабинет">
        <img class="avatar" src="{% static 'main/img/p_25.png' %}" alt="Кабинет">
      </a>
    {% else %}
      <a class="avatar-link" href="{% url 'login' %}?next={{ request.get_full_path|urlencode }}" title="Войти">
        <img class="avatar avatar--guest" src="{% static 'main/img/p_25.png' %}" alt="Войти">
      </a>
    {% endif %}
  </header>

  <div class="page-main">
    <aside class="side">
      {% include "main/nav.html" %}
    </aside>

    <main class="content">
      {% block content %}{% endblock %}
    </main>
  </div>

  <footer class="site-footer">
    {% include 'main/footer.html' %}
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
          crossorigin="anonymous"></script>
</body>
</html>
